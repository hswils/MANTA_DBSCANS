fastran_init.init() started
state_files: s000001.00001 g000001.00001 i000001.00001
create null s000001.00001
create null g000001.00001
create null i000001.00001
fastran_init.step() started
tokamak_id = MANTA
shot_number = 000001
INPUT_DIR = /pscratch/sd/h/hswils/example2_builddb3_withrad/input
model_beam = 0
start dakota update
update_namelist called
instate R0 updated
instate A0 updated
instate KAPPA updated
instate DELTA updated
instate B0 updated
instate IP updated
instate NE_AXIS updated
instate NE_PED updated
instate NE_SEP updated
instate TE_AXIS updated
instate TE_PED updated
instate TI_AXIS updated
instate TI_PED updated
instate XMID updated
instate XWID updated
instate H98_TARGET updated
instate_method: model
Simple shape
ne from model profile, ped
te from model profile, ped
ti from model profile, ped
density_beam from model profile, parab
j_tot from model profile, parab
omega from model profile, parab
zeff from model profile, const
tbeami from model profile, const
density_alpha from model profile, zero
walpha from model profile, zero
wbeam from the model profile
density_model = 1: impurity = f*ne
init from instate: instate
usng analytic volume
end
rho_rad prad 100 100
integrated :  0.0
rho pohme 100 100
integrated :  0.0
Icurt=2.888e+00MA
rho_nbi pbe 100 100
integrated :  0.0
rho_nbi pbi 100 100
integrated :  0.0
rho_nbi sbedep 100 100
integrated :  0.0
rho_nbi tqbe 100 100
integrated :  0.0
Icurbeam=0.000e+00MA
rho_ecrf peech 100 100
integrated :  0.0
rho_icrf picrf_totals 6 100
integrated :  4561275.4637605725
rho_icrf picrf_totals 6 100
integrated :  28240221.310364272
Icurech=0.000e+00MA
Icurich=0.000e+00MA
fastran_init.finalize() called
********************************************************************************
FASTRAN DIRVER INIT
PORTS (all) = ['INIT', 'DRIVER', 'EQ0', 'TR0', 'RAD', 'EQ', 'TR']
PORTS = ['INIT', 'DRIVER', 'EQ0', 'TR0', 'RAD', 'EQ', 'TR']
SIMULATION_MODE = NORMAL
*** t0 = 0
EQ0 init ********
>>> efit.init() started
INPUT: SCALE_GS found 1 , mapped value =  enabled
INPUT: R0_SCALE not found, use default value: 1.7
INPUT: B0_SCALE not found, use default value: 2.0
efit time = 1
init_run =  1
force free
scaled  1.7 2.0
NCAPTC: : NetCDF: Variable not found
Warning: ieee_overflow is signaling
Warning: ieee_underflow is signaling
Warning: ieee_inexact is signaling
FORTRAN STOP
ps_update disabled
Icurt=3.379e+00MA
TR0 init ********
fastran.init() entered
RAD init ********
radiation.init() started
model_beam = 0
[36]
z_imp = 36, spec = krypton
[1.e+16 5.e+16 1.e+17 1.e+18 1.e+19]
9999999999999998.0 9.999999999999999e+20
1.0 49999.9995007974
EQ init ********
>>> efit.init() started
INPUT: SCALE_GS found 1 , mapped value =  enabled
INPUT: R0_SCALE not found, use default value: 1.7
INPUT: B0_SCALE not found, use default value: 2.0
efit time = 4
init_run =  0
TR init ********
fastran.init() entered
nstep_pre: 1

========================================================================
= fastran driver: preprocess iteration number =  0

EQ0 step
>>> efit.step() started
INPUT: PRESSURE found kinetic , mapped value =  kinetic
INPUT: RELAX_PROFILE not found, use default value: 0
INPUT: RELAX_METRIC not found, use default value: 0.5
INPUT: BETAN_TARGET not found, use default value: -1.0
model_pressure = kinetic
betan = 1.3982996368577454
INPUT: TOPOLOGY found DN , mapped value =  DN
INPUT: ERROR not found, use default value: 1.0e-4
INPUT: MAX_EFIT_ERROR not found, use default value: 0.1
init_run_step = 0
niter =  10
*** generate kfile 0
r0 = 4.55
b0 = 11.0
ip = 9999999.995
ip, ip cal, ip/(ip cal) = 10.000 3.379 2.959
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
run efit
efit, subprocess
elapsed time =  0.360  1.193
error_efit = 5.84e-05
*** generate kfile 1
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.341 2.993
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.1226293293242929
diff_f = 0.5436058777395861
run efit
efit, subprocess
elapsed time =  0.380  1.211
error_efit = 7.491e-05
*** generate kfile 2
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.316 3.016
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.11120961629238109
diff_f = 0.3789380795053178
run efit
efit, subprocess
elapsed time =  0.373  1.170
error_efit = 6.298e-05
*** generate kfile 3
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.299 3.031
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.07621299035655664
diff_f = 0.20634866502456106
run efit
efit, subprocess
elapsed time =  0.421  1.185
error_efit = 5.935e-05
*** generate kfile 4
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
  ps_init_tag: Plasma State v2.055 f90 module initialization.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.288 3.041
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.04562706420119929
diff_f = 0.10571579382028627
run efit
efit, subprocess
elapsed time =  0.434  1.145
error_efit = 5.984e-05
*** generate kfile 5
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.281 3.048
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.02504178552171542
diff_f = 0.05255117096791655
run efit
efit, subprocess
elapsed time =  0.372  1.117
error_efit = 6.476e-05
*** generate kfile 6
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.276 3.052
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.012886925436036444
diff_f = 0.025232013397735228
run efit
efit, subprocess
elapsed time =  0.398  1.096
error_efit = 8.984e-05
*** generate kfile 7
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.274 3.055
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.006336040227337718
diff_f = 0.01164335924684125
run efit
efit, subprocess
elapsed time =  0.407  1.104
error_efit = 8.924e-05
*** generate kfile 8
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.272 3.056
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.003000082632986168
diff_f = 0.005140449227524466
converged
Icurt=3.271e+00MA
EQ0 step finished
TR0 step
fastran.step() entered
update_next = disabled
update_instate =  True
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
model_beam = 0
dump_vol_profile : rho_nbi pbe 0.0
dump_vol_profile : rho_nbi pbi 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_fus pfuse 0.0
dump_vol_profile : rho_fus pfusi 0.0
dump_vol_profile : rho_fus pfusth 0.0
dump_vol_profile : rho_ecrf peech 0.0
dump_vol_profile : rho_icrf picrf_totals 4561275.4637605725
dump_vol_profile : rho_lhrf pelh 0.0
dump_vol_profile : rho_icrf picrf_totals 28240221.310364272
dump_vol_profile : rho_lhrf pilh 0.0
dump_vol_profile : rho_nbi tqbe 0.0
dump_vol_profile : rho_nbi tqbi 0.0
dump_vol_profile : rho_nbi tqbjxb 0.0
dump_vol_profile : rho_nbi tqbth 0.0
dump_vol_profile : rho_nbi sbedep 0.0
dump_vol_profile : rho_nbi sbehalo 0.0
dump_vol_profile : rho sn_trans 0.0
dump_vol_profile : rho_rad prad 0.0
dump_vol_profile : rho pohme 0.0
/global/common/software/atom/perlmutter/binaries/fastran/default/xfastran_ver1.00_ser
ncpu =  1
n1d  =  1
nky  =  1
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
nspec_th = 3
Icurt=1.000e+01MA
Icurr_bootstrap=2.375e+00MA
Icurr_ohmic=0.000e+00MA
rho_fus pfuse 100 100
integrated :  64697836.97418818
rho_fus pfusi 100 100
integrated :  20846315.15553683
model_beam = 0
density_model = 1: impurity = f*ne
TR0 step finished
number of iteration : 5

========================================================================
= fastran driver: iteration number =  0

RAD step
radiation.step() started
model_beam = 0
0 [1537546.99285638 1537546.99285638 1534754.3497484  1531787.35097623
 1528644.74750087 1525325.22842168 1521827.43777083 1518149.9850055
 1514291.45513384 1510250.42446192 1506025.46695237 1501615.1671421
 1497018.13590823 1492233.01071166 1487258.47504221 1482093.26561537
 1476736.17970879 1471186.08535093 1465441.93385147 1459502.76348934
 1453512.05914373 1449861.58223662 1446030.02634931 1442012.26143941
 1437803.35441308 1433398.5827087  1428793.44602311 1423983.67316039
 1418965.23802867 1413734.36792739 1408287.54733737 1402621.56822364
 1396733.43504583 1390620.46137093 1384280.25414099 1377710.72012919
 1370910.06275209 1363876.79343145 1356609.73192545 1349108.01083916
 1341371.07650154 1336929.56181559 1333075.05971449 1328898.24163957
 1324395.89038498 1319565.3260235  1314404.40887057 1308911.53478466
 1303085.63407606 1296926.16902227 1290433.12859153 1283607.02485046
 1276448.88459699 1268960.24618042 1228044.39390378 1088940.23120097
  953790.35757649  822646.79902872  695554.6105371   572551.97239991
  453670.2954172   338934.33793788  228362.33228417  121966.11367944
   19751.25930363  133253.3506189   293021.86845418  445705.79142758
  591335.65434015  729951.3029435   861601.59742119  986344.10770589
 1104244.80223377 1187675.84727321 1188951.67900415 1189151.21370082
 1188297.15086956 1186413.2716476  1183524.36098385 1179656.12958243
 1174835.10355806 1178200.35913115 1180130.49468252 1180620.15365443
 1179708.1926085  1177430.60582947 1173815.92342171 1175258.34766122
 1179200.8889199  1180873.38055005 1180007.80297224 1175962.75705835
 1167340.39944785 1162082.86383097 1148420.65683374 1115470.6148226
 1070136.12684385 1064217.02905775 1227387.69975538 1368948.86498055
  447477.14245485]
rho_rad prad 100 100
integrated :  193906259.7363376
RAD step finished
EQ step
>>> efit.step() started
INPUT: PRESSURE found kinetic , mapped value =  kinetic
INPUT: RELAX_PROFILE not found, use default value: 0
INPUT: RELAX_METRIC not found, use default value: 0.5
INPUT: BETAN_TARGET not found, use default value: -1.0
model_pressure = kinetic
betan = 1.3679373220619802
INPUT: TOPOLOGY found DN , mapped value =  DN
INPUT: ERROR not found, use default value: 1.0e-4
INPUT: MAX_EFIT_ERROR not found, use default value: 0.1
init_run_step = 0
niter =  10
*** generate kfile 0
r0 = 4.55
b0 = 11.0
ip = 9999999.995
ip, ip cal, ip/(ip cal) = 10.000 10.002 1.000
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
run efit
efit, subprocess
elapsed time =  0.344  1.081
error_efit = 6.201e-05
*** generate kfile 1
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 10.001 1.000
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.00012115182696571114
diff_f = 0.00016803462838329867
converged
Icurt=1.000e+01MA
EQ step finished
TR step
fastran.step() entered
update_next = disabled
update_instate =  True
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
model_beam = 0
dump_vol_profile : rho_nbi pbe 0.0
dump_vol_profile : rho_nbi pbi 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_fus pfuse 64697836.97418818
dump_vol_profile : rho_fus pfusi 20846315.15553683
dump_vol_profile : rho_fus pfusth 0.0
dump_vol_profile : rho_ecrf peech 0.0
dump_vol_profile : rho_icrf picrf_totals 4561275.4637605725
dump_vol_profile : rho_lhrf pelh 0.0
dump_vol_profile : rho_icrf picrf_totals 28240221.310364272
dump_vol_profile : rho_lhrf pilh 0.0
dump_vol_profile : rho_nbi tqbe 0.0
dump_vol_profile : rho_nbi tqbi 0.0
dump_vol_profile : rho_nbi tqbjxb 0.0
dump_vol_profile : rho_nbi tqbth 0.0
dump_vol_profile : rho_nbi sbedep 0.0
dump_vol_profile : rho_nbi sbehalo 0.0
dump_vol_profile : rho sn_trans 0.0
dump_vol_profile : rho_rad prad 193906259.7363376
dump_vol_profile : rho pohme 0.0
/global/common/software/atom/perlmutter/binaries/fastran/default/xfastran_ver1.05
ncpu =  126
n1d  =  6
nky  =  21
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr

fastran_init.init() started
state_files: s000001.00001 g000001.00001 i000001.00001
create null s000001.00001
create null g000001.00001
create null i000001.00001
fastran_init.step() started
tokamak_id = MANTA
shot_number = 000001
INPUT_DIR = /pscratch/sd/h/hswils/example2_builddb3_withrad/input
model_beam = 0
start dakota update
update_namelist called
instate R0 updated
instate A0 updated
instate KAPPA updated
instate DELTA updated
instate B0 updated
instate IP updated
instate NE_AXIS updated
instate NE_PED updated
instate NE_SEP updated
instate TE_AXIS updated
instate TE_PED updated
instate TI_AXIS updated
instate TI_PED updated
instate XMID updated
instate XWID updated
instate H98_TARGET updated
instate_method: model
Simple shape
ne from model profile, ped
te from model profile, ped
ti from model profile, ped
density_beam from model profile, parab
j_tot from model profile, parab
omega from model profile, parab
zeff from model profile, const
tbeami from model profile, const
density_alpha from model profile, zero
walpha from model profile, zero
wbeam from the model profile
density_model = 1: impurity = f*ne
init from instate: instate
usng analytic volume
end
rho_rad prad 100 100
integrated :  0.0
rho pohme 100 100
integrated :  0.0
Icurt=2.888e+00MA
rho_nbi pbe 100 100
integrated :  0.0
rho_nbi pbi 100 100
integrated :  0.0
rho_nbi sbedep 100 100
integrated :  0.0
rho_nbi tqbe 100 100
integrated :  0.0
Icurbeam=0.000e+00MA
rho_ecrf peech 100 100
integrated :  0.0
rho_icrf picrf_totals 6 100
integrated :  4561275.4637605725
rho_icrf picrf_totals 6 100
integrated :  28240221.310364272
Icurech=0.000e+00MA
Icurich=0.000e+00MA
fastran_init.finalize() called
********************************************************************************
FASTRAN DIRVER INIT
PORTS (all) = ['INIT', 'DRIVER', 'EQ0', 'TR0', 'RAD', 'EQ', 'TR']
PORTS = ['INIT', 'DRIVER', 'EQ0', 'TR0', 'RAD', 'EQ', 'TR']
SIMULATION_MODE = NORMAL
*** t0 = 0
EQ0 init ********
>>> efit.init() started
INPUT: SCALE_GS found 1 , mapped value =  enabled
INPUT: R0_SCALE not found, use default value: 1.7
INPUT: B0_SCALE not found, use default value: 2.0
efit time = 1
init_run =  1
force free
scaled  1.7 2.0
NCAPTC: : NetCDF: Variable not found
Warning: ieee_overflow is signaling
Warning: ieee_underflow is signaling
Warning: ieee_inexact is signaling
FORTRAN STOP
ps_update disabled
Icurt=3.379e+00MA
TR0 init ********
fastran.init() entered
RAD init ********
radiation.init() started
model_beam = 0
[36]
z_imp = 36, spec = krypton
[1.e+16 5.e+16 1.e+17 1.e+18 1.e+19]
9999999999999998.0 9.999999999999999e+20
1.0 49999.9995007974
EQ init ********
>>> efit.init() started
INPUT: SCALE_GS found 1 , mapped value =  enabled
INPUT: R0_SCALE not found, use default value: 1.7
INPUT: B0_SCALE not found, use default value: 2.0
efit time = 3
init_run =  0
TR init ********
fastran.init() entered
nstep_pre: 1

========================================================================
= fastran driver: preprocess iteration number =  0

EQ0 step
>>> efit.step() started
INPUT: PRESSURE found kinetic , mapped value =  kinetic
INPUT: RELAX_PROFILE not found, use default value: 0
INPUT: RELAX_METRIC not found, use default value: 0.5
INPUT: BETAN_TARGET not found, use default value: -1.0
model_pressure = kinetic
betan = 1.2795509227935122
INPUT: TOPOLOGY found DN , mapped value =  DN
INPUT: ERROR not found, use default value: 1.0e-4
INPUT: MAX_EFIT_ERROR not found, use default value: 0.1
init_run_step = 0
niter =  10
*** generate kfile 0
r0 = 4.55
b0 = 11.0
ip = 9999999.995
ip, ip cal, ip/(ip cal) = 10.000 3.379 2.959
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
run efit
efit, subprocess
elapsed time =  0.333  1.209
error_efit = 7.531e-05
*** generate kfile 1
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.337 2.996
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.1212085587266047
diff_f = 0.589717988584176
run efit
efit, subprocess
elapsed time =  0.387  1.181
error_efit = 7.705e-05
*** generate kfile 2
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.311 3.020
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.109584810619009
diff_f = 0.41641460790698404
run efit
efit, subprocess
elapsed time =  0.414  1.191
error_efit = 4.691e-05
*** generate kfile 3
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.294 3.035
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.07521026237025594
diff_f = 0.2267070214119997
run efit
efit, subprocess
elapsed time =  0.390  1.181
error_efit = 7.606e-05
*** generate kfile 4
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
  ps_init_tag: Plasma State v2.055 f90 module initialization.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
  %ps_update_fromxplasma: allocating nr,nz  =          129 ,         129
  %ps_update_fromxplasma: allocating nlim   =            5
  %ps_mhdeq_derive: compute <1/R^2> and <|grad(rho)|^2/R^2>.
  %ps_mhdeq_derive: compute metric averages <1/R>, <|grad(rho)|>, etc.
  %ps_mhdeq_derive: compute R & Z minmax profiles; triangularity, etc.
  %ps_mhdeq_derive: compute <1/B^2>, NCLASS moments, etc.
  %ps_mhdeq_nclass: allocating 16 Pfirsch-Schlutter moments profiles.
  %ps_mhdeq_derive: compute NC sqrt-singular flux surface averages.
  %ps_mhdeq_derive: compute profiles of Bmin, Bmax.
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.283 3.046
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.04508850538881151
diff_f = 0.11598182409515638
run efit
efit, subprocess
elapsed time =  0.404  1.186
error_efit = 8.355e-05
*** generate kfile 5
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.277 3.052
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.024789244608348786
diff_f = 0.057483983463379386
run efit
efit, subprocess
elapsed time =  0.418  1.135
error_efit = 5.292e-05
*** generate kfile 6
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.273 3.056
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.01279409997411752
diff_f = 0.02751505980546447
run efit
efit, subprocess
elapsed time =  0.416  1.108
error_efit = 6.97e-05
*** generate kfile 7
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.270 3.058
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.00626948313309205
diff_f = 0.012629212455807417
run efit
efit, subprocess
elapsed time =  0.417  1.140
error_efit = 5.229e-05
*** generate kfile 8
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 3.269 3.059
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.0029448305478869743
diff_f = 0.005533816610448821
converged
Icurt=3.267e+00MA
EQ0 step finished
TR0 step
fastran.step() entered
update_next = disabled
update_instate =  True
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
model_beam = 0
dump_vol_profile : rho_nbi pbe 0.0
dump_vol_profile : rho_nbi pbi 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_fus pfuse 0.0
dump_vol_profile : rho_fus pfusi 0.0
dump_vol_profile : rho_fus pfusth 0.0
dump_vol_profile : rho_ecrf peech 0.0
dump_vol_profile : rho_icrf picrf_totals 4561275.4637605725
dump_vol_profile : rho_lhrf pelh 0.0
dump_vol_profile : rho_icrf picrf_totals 28240221.310364272
dump_vol_profile : rho_lhrf pilh 0.0
dump_vol_profile : rho_nbi tqbe 0.0
dump_vol_profile : rho_nbi tqbi 0.0
dump_vol_profile : rho_nbi tqbjxb 0.0
dump_vol_profile : rho_nbi tqbth 0.0
dump_vol_profile : rho_nbi sbedep 0.0
dump_vol_profile : rho_nbi sbehalo 0.0
dump_vol_profile : rho sn_trans 0.0
dump_vol_profile : rho_rad prad 0.0
dump_vol_profile : rho pohme 0.0
/global/common/software/atom/perlmutter/binaries/fastran/default/xfastran_ver1.00_ser
ncpu =  1
n1d  =  1
nky  =  1
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
nspec_th = 3
Icurt=1.000e+01MA
Icurr_bootstrap=2.185e+00MA
Icurr_ohmic=0.000e+00MA
rho_fus pfuse 100 100
integrated :  59437285.12744431
rho_fus pfusi 100 100
integrated :  19154025.409251362
model_beam = 0
density_model = 1: impurity = f*ne
TR0 step finished
number of iteration : 5

========================================================================
= fastran driver: iteration number =  0

RAD step
radiation.step() started
model_beam = 0
0 [1537688.25002428 1537688.25002428 1535028.01325642 1532207.83410232
 1529225.87017424 1526080.20392889 1522768.86242407 1519289.82673188
 1515641.04712545 1511820.45618218 1507825.97892063 1503655.5463997
 1499307.11306075 1494778.65759869 1490068.20423021 1485173.82988916
 1480093.67448623 1474825.95103223 1469368.95984972 1463721.09214887
 1460577.13653717 1457392.6521096  1454030.5988014  1450484.88033472
 1446749.61142313 1442819.1335539  1438688.02967028 1434351.12833729
 1429803.52391687 1425040.58547233 1420057.96110479 1414851.62871245
 1409417.80252237 1403753.03087607 1397854.17974012 1391718.4430112
 1385343.33596845 1378726.7104471  1371866.75411089 1368118.95750788
 1365500.11988676 1362549.43348187 1359261.80197069 1355632.71161758
 1351658.23152522 1347335.01777697 1342660.31164922 1337631.9376784
 1332248.30203374 1326508.39027558 1320411.76084161 1313958.5428964
 1161433.48541096 1010833.5034684   864345.75339375  722038.80042648
  583973.55082664  450203.33365635  320774.00559187  195724.05662156
   75084.72578305   69994.43364248  260220.4847687   442851.10079588
  617880.17675672  785312.74040373  945164.6658952  1097462.38527306
 1242242.59009729 1291159.42966686 1296620.03273664 1300844.27344165
 1303851.46389371 1305662.34436321 1306299.02222644 1310592.50358396
 1320779.81955323 1329195.95843271 1335878.24501975 1340865.63171037
 1346508.84886099 1363781.71959738 1378484.94484536 1390682.22062676
 1400436.94014997 1424838.85495996 1452444.80204721 1476054.61016457
 1495684.76884314 1546641.03175493 1593107.81453659 1630942.646847
 1694885.11074217 1756972.9359523  1785124.41806666 1814446.51413911
 1770729.12436968 1711916.90016645 1684774.57995482 1000298.62643112
  429257.18063189]
rho_rad prad 100 100
integrated :  225561001.99358544
RAD step finished
EQ step
>>> efit.step() started
INPUT: PRESSURE found kinetic , mapped value =  kinetic
INPUT: RELAX_PROFILE not found, use default value: 0
INPUT: RELAX_METRIC not found, use default value: 0.5
INPUT: BETAN_TARGET not found, use default value: -1.0
model_pressure = kinetic
betan = 1.250884669912429
INPUT: TOPOLOGY found DN , mapped value =  DN
INPUT: ERROR not found, use default value: 1.0e-4
INPUT: MAX_EFIT_ERROR not found, use default value: 0.1
init_run_step = 0
niter =  10
*** generate kfile 0
r0 = 4.55
b0 = 11.0
ip = 9999999.995
ip, ip cal, ip/(ip cal) = 10.000 10.002 1.000
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
run efit
efit, subprocess
elapsed time =  0.346  1.098
error_efit = 9.769e-05
*** generate kfile 1
apply underrelaxation
r0 = 4.55
b0 = 11.0
ip = 9999999.995
inmtric under-relax: 0.5
ip, ip cal, ip/(ip cal) = 10.000 10.001 1.000
weigting upper xpoint: [2, 3, 4, 5]
weigting lower xpoint: [9, 10, 11, 12]
diff_p = 0.00014256549348867192
diff_f = 0.00021907058675275462
converged
Icurt=1.000e+01MA
EQ step finished
TR step
fastran.step() entered
update_next = disabled
update_instate =  True
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
model_beam = 0
dump_vol_profile : rho_nbi pbe 0.0
dump_vol_profile : rho_nbi pbi 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_nbi pbth 0.0
dump_vol_profile : rho_fus pfuse 59437285.12744431
dump_vol_profile : rho_fus pfusi 19154025.409251362
dump_vol_profile : rho_fus pfusth 0.0
dump_vol_profile : rho_ecrf peech 0.0
dump_vol_profile : rho_icrf picrf_totals 4561275.4637605725
dump_vol_profile : rho_lhrf pelh 0.0
dump_vol_profile : rho_icrf picrf_totals 28240221.310364272
dump_vol_profile : rho_lhrf pilh 0.0
dump_vol_profile : rho_nbi tqbe 0.0
dump_vol_profile : rho_nbi tqbi 0.0
dump_vol_profile : rho_nbi tqbjxb 0.0
dump_vol_profile : rho_nbi tqbth 0.0
dump_vol_profile : rho_nbi sbedep 0.0
dump_vol_profile : rho_nbi sbehalo 0.0
dump_vol_profile : rho sn_trans 0.0
dump_vol_profile : rho_rad prad 225561001.99358544
dump_vol_profile : rho pohme 0.0
/global/common/software/atom/perlmutter/binaries/fastran/default/xfastran_ver1.05
ncpu =  126
n1d  =  6
nky  =  21
[1, 1, 36]
['D', 'T', 'Kr']
ion D
ion T
imp Kr
